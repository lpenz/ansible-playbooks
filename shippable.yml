language: none
build:
  pre_ci:
    - docker build -t ansible-playbooks:latest .
  pre_ci_boot:
    image_name: ansible-playbooks
    image_tag: latest
    pull: false
    options: "-v $PWD:/home/user/work -e MY_UID=$UID"
  ci:
    - grep -l '#!/bin/sh'   roles/*/files/scripts/* | xargs shellcheck
    - grep -l '#!/bin/bash' roles/*/files/scripts/* | xargs shellcheck
    - grep -l '#!/usr/bin/python' roles/*/files/scripts/* | xargs flake8
    - grep -l '#!/usr/bin/python' roles/*/files/scripts/* | xargs py3kwarn
    - nosetests --with-doc --exe
    - ansible-playbook -i localhost, -c local -v playbook-sudo-term.yml
    - ansible-playbook -i localhost, -c local -v playbook-user-term.yml
